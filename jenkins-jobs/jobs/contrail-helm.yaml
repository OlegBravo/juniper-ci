- job-template:
    name: contrail-helm-{project}
    description: "Deploys Kubernetes plus Contrail in AIO mode in host {project}"
    defaults: global
    properties:
      - build-discarder
    parameters:
      - choice:
          name: CLEAN_ENV
          choices:
            - always
            - on_success
            - never
    scm:
      - juniper-ci
      - openstack-helm
    builders:
      - shell: |
          #!/bin/bash -e
          ./juniper-ci/contrail-helm/run-{project}.sh
    publishers:
      - archive:
          artifacts: 'logs/**'
          allow-empty: true

- project:
   name: contrail-helm
   project:
    - aws-ubuntu
    - aws-centos
    - server-ubuntu
    - server-centos
   jobs:
    - 'contrail-helm-{project}'
