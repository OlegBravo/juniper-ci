- job:
    name: Juju-OVS-OpenStack-KVM
    description: 'OVS+OpenStack on KVM by Juju'
    defaults: global
    node: slave01
    concurrent: true
    parameters:
      - choice:
          name: CLEAN_BEFORE
          choices:
            - 'false'
            - 'true'
            - clean_and_exit
      - choice:
          name: CLEAN_ENV
          choices:
            - always
            - on_success
            - never
      - choice:
          name: VERSION
          description: "Version of the OpenStack. mitaka implies trusty and newton/ocata implies xenial."
          choices:
            - ocata
    scm:
      - juniper-ci
    builders:
      - shell: |
          #!/bin/bash -e
          desc="$VERSION $DEPLOY_TYPE"
          echo "DESCRIPTION $desc"
      - description-setter:
          regexp: "DESCRIPTION (.*)"
      - shell: |
          #!/bin/bash -e
          export SERIES='xenial'
          ./juniper-ci/juju/bmc-ovs/deploy_all.sh
    publishers:
      - archive:
          artifacts: 'logs/**'
          allow-empty: 'true'
